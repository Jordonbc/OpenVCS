<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenVCS</title>
  <link rel="stylesheet" href="styles.css" />
  <script type="module" src="main.js" defer></script>
</head>
<body>
  <div class="app" id="app">
    <!-- Titlebar -->
    <header class="titlebar" role="banner">
      <div class="repo-switch" id="repo-switch" title="Switch repository (Ctrl+R)" role="button" tabindex="0" aria-haspopup="dialog">
        <div class="repo-meta">
          <div class="repo-title" id="repo-title">Click to open Repo</div>
          <div class="repo-branch" id="repo-branch">No repo open</div>
        </div>
        <span class="chev" aria-hidden="true">â–¾</span>
      </div>

      <button class="branch-switch" id="branch-switch" title="Switch branch" aria-haspopup="listbox" aria-expanded="false">
        <span class="branch-dot" aria-hidden="true"></span>
        <span id="branch-name">No repo open</span>
        <span class="chev" aria-hidden="true">â–¾</span>
      </button>

      <div class="title-actions">
        <button class="btn" id="fetch-btn" title="Fetch/Pull (F5)">Fetch</button>
        <button class="btn" id="push-btn" title="Push">Push</button>
        <button class="btn icon" id="theme-btn" title="Toggle theme" aria-label="Toggle theme">ðŸŒ“</button>
      </div>
    </header>

    <!-- Tabs -->
    <nav class="tabs" role="tablist" aria-label="Primary views">
      <button class="tab active" data-tab="changes" role="tab" aria-selected="true" id="tab-changes">Changes</button>
      <button class="tab" data-tab="history" role="tab" aria-selected="false" id="tab-history">History</button>
    </nav>

    <!-- Work area -->
    <section class="work" aria-label="Workspace">
      <!-- Left column -->
      <aside class="panel left" id="left" aria-label="List panel">
        <div class="left-head">
          <div class="filter">
            <span class="filter-icon" aria-hidden="true">ðŸ”Ž</span>
            <input id="filter" type="search" placeholder="Filter filesâ€¦ (Ctrl+F)" aria-label="Filter files or commits" />
          </div>
          <span class="badge" id="changes-count">0 items</span>
        </div>
        <ul class="list" id="file-list" role="listbox" aria-label="Items"></ul>
      </aside>

      <!-- Resizer -->
      <div class="resizer" id="resizer" title="Resize panel" aria-hidden="true"></div>

      <!-- Right column -->
      <main class="panel right" id="right" role="main">
        <div class="diff-head">
          <div class="path" id="diff-path">Select an item</div>
          <div class="meta" id="diff-meta" aria-label="Diff settings">
            <span>LF</span><span>UTF-8</span><span>Unified</span>
          </div>
        </div>

        <div class="diff" id="diff" aria-live="polite" aria-label="Diff view"></div>

        <!-- Commit panel (hidden on History tab via JS) -->
        <section class="commit" id="commit" aria-label="Commit changes">
          <div class="inputs">
            <input id="commit-summary" placeholder="Summary (required)" aria-label="Commit summary" />
            <textarea id="commit-desc" placeholder="Description (optional)" aria-label="Commit description"></textarea>
          </div>
          <div class="actions">
            <span class="kbd">Ctrl+Enter</span>
            <button class="btn primary" id="commit-btn">Commit</button>
          </div>
        </section>
      </main>
    </section>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
      <div class="hints">
        Shortcuts: <span class="kbd">Ctrl+R</span> repo Â·
        <span class="kbd">Ctrl+F</span> filter Â·
        <span class="kbd">Ctrl+Enter</span> commit Â·
        <span class="kbd">F5</span> fetch
      </div>
      <div id="status" aria-live="polite">Ready</div>
    </footer>
  </div>

  <!-- Command Sheet (Clone / Add / Switch) -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="backdrop" data-close></div>
    <div class="dialog sheet" role="dialog" aria-modal="true" aria-labelledby="sheet-title">
      <div class="sheet-head">
        <div class="seg" role="tablist" aria-label="Repository actions">
          <button class="seg-btn active" data-sheet="clone" role="tab" aria-selected="true" id="sheet-tab-clone">Clone</button>
          <button class="seg-btn" data-sheet="add" role="tab" aria-selected="false" id="sheet-tab-add">Add Existing</button>
          <button class="seg-btn" data-sheet="switch" role="tab" aria-selected="false" id="sheet-tab-switch">Switch</button>
        </div>
        <button class="icon close" data-close aria-label="Close">âœ•</button>
      </div>

      <!-- Clone -->
      <section class="sheet-body" id="sheet-clone" role="tabpanel" aria-labelledby="sheet-tab-clone">
        <h3 id="sheet-title">Clone repository</h3>
        <div class="group">
          <label for="clone-url">Source</label>
          <div class="input-row">
            <div class="seg small">
              <button class="seg-btn small active" data-proto="https" type="button">HTTPS</button>
              <button class="seg-btn small" data-proto="ssh" type="button">SSH</button>
            </div>
            <input id="clone-url" placeholder="https://github.com/user/repo.git or git@github.com:user/repo.git" />
          </div>
          <div class="hint" id="clone-url-hint">Enter a valid Git URL.</div>
        </div>
        <div class="group">
          <label for="clone-path">Destination</label>
          <div class="input-row">
            <input id="clone-path" placeholder="/home/jordon/Projects" />
            <button class="pick" id="browse-clone" type="button">Browseâ€¦</button>
          </div>
          <div class="hint">A new folder will be created inside the destination.</div>
        </div>
        <div class="sheet-actions">
          <button class="tbtn" data-close type="button">Cancel</button>
          <button class="tbtn primary big" id="do-clone" type="button" disabled>Clone</button>
        </div>
      </section>

      <!-- Add Existing -->
      <section class="sheet-body hidden" id="sheet-add" role="tabpanel" aria-labelledby="sheet-tab-add">
        <h3>Add existing repository</h3>
        <div class="group">
          <label for="add-path">Repository folder</label>
          <div class="input-row">
            <input id="add-path" placeholder="/path/to/repo (must contain .git)" />
            <button class="pick" id="browse-add" type="button">Browseâ€¦</button>
          </div>
          <div class="hint" id="add-path-hint">Select a folder that already contains a Git repo.</div>
        </div>
        <div class="sheet-actions">
          <button class="tbtn" data-close type="button">Cancel</button>
          <button class="tbtn primary big" id="do-add" type="button" disabled>Add</button>
        </div>
      </section>

      <!-- SWITCH -->
      <section class="sheet-body hidden" id="sheet-switch" role="tabpanel" aria-labelledby="sheet-tab-switch">
        <h3>Switch repository</h3>
        <div class="group">
          <label>Recent</label>
          <ul class="recent" id="recent-list"></ul>
        </div>
        <div class="sheet-actions">
          <button class="tbtn" data-close type="button">Cancel</button>
          <button class="tbtn primary big" id="do-switch" type="button" disabled>Open</button>
        </div>
      </section>
    </div>
  </div>
  
  <!-- Branch popover -->
  <div class="popover" id="branch-pop" role="dialog" aria-modal="false" aria-label="Branches" hidden>
    <div class="pop-head">
      <input id="branch-filter" type="search" placeholder="Find or create branchâ€¦" aria-label="Filter branches">
      <button class="pick" id="branch-new" type="button">Newâ€¦</button>
    </div>
    <ul class="pop-list" id="branch-list" role="listbox" aria-label="Branch list"></ul>
  </div>

  <!-- About modal -->
  <div class="modal" id="about-modal" aria-hidden="true">
    <div class="backdrop" data-close></div>
    <div class="dialog sheet" role="dialog" aria-modal="true" aria-labelledby="about-title">
      <div class="sheet-head">
        <h3 id="about-title" style="margin:0">About OpenVCS</h3>
        <button class="icon close" data-close aria-label="Close">âœ•</button>
      </div>
      <section class="sheet-body" style="display:grid; gap:.8rem;">
        <div style="display:flex; align-items:center; gap:.8rem;">
          <div style="width:40px; height:40px; border-radius:8px; background:var(--surface-2); display:flex; align-items:center; justify-content:center; font-weight:700;">
            OV
          </div>
          <div>
            <div style="font-weight:700;">OpenVCS <span id="about-version" style="font-weight:400; color:var(--muted)"></span></div>
            <div id="about-build" style="font-size:.85rem; color:var(--muted)"></div>
          </div>
        </div>

        <div style="font-size:.95rem;">
          A fast, cross-platform Git client built with Rust &amp; Tauri.
        </div>

        <div style="display:flex; gap:.5rem; flex-wrap:wrap;">
          <a id="about-home" class="tbtn" href="#" target="_blank" rel="noreferrer">Homepage</a>
          <a id="about-repo" class="tbtn" href="#" target="_blank" rel="noreferrer">Repository</a>
          <button class="tbtn" id="about-licenses" type="button">Licenses</button>
        </div>
      </section>
    </div>
  </div>

  <!-- Settings modal -->
  <div class="modal" id="settings-modal" aria-hidden="true">
    <div class="backdrop" data-close></div>
    <div class="dialog sheet" role="dialog" aria-modal="true" aria-labelledby="settings-title">
      <div class="sheet-head">
        <h3 id="settings-title" style="margin:0">Settings</h3>
        <button class="icon close" data-close aria-label="Close">âœ•</button>
      </div>

      <section class="sheet-body" style="display:grid; grid-template-columns: 220px 1fr; gap:1rem; min-height:420px;">
        <!-- Sidebar -->
        <nav aria-label="Settings sections">
          <ul id="settings-nav" class="list" style="list-style:none; padding:0; margin:0;">
            <li><button class="seg-btn active" data-section="general">General</button></li>
            <li><button class="seg-btn" data-section="git">Git</button></li>
            <li><button class="seg-btn" data-section="diff">Diff & Merge</button></li>
            <li><button class="seg-btn" data-section="lfs">LFS</button></li>
            <li><button class="seg-btn" data-section="performance">Performance</button></li>
            <li><button class="seg-btn" data-section="ux">UX</button></li>
            <!-- You can add: integrations, advanced, experimental, logging, network later -->
          </ul>
        </nav>

        <!-- Panels -->
        <div id="settings-panels" style="display:grid; gap:1rem;">
          <!-- General -->
          <form class="panel-form" data-panel="general">
            <div class="group">
              <label for="set-theme">Theme</label>
              <select id="set-theme">
                <option value="system">System</option>
                <option value="light">Light</option>
                <option value="dark">Dark</option>
              </select>
            </div>

            <div class="group">
              <label for="set-language">Language</label>
              <select id="set-language">
                <option value="system">System</option>
                <option value="en">English</option>
              </select>
            </div>

            <div class="group">
              <label for="set-update-channel">Update channel</label>
              <select id="set-update-channel">
                <option value="stable">Stable</option>
                <option value="beta">Beta</option>
                <option value="nightly">Nightly</option>
              </select>
            </div>

            <div class="group">
              <label class="checkbox">
                <input type="checkbox" id="set-reopen-last" />
                Reopen last repositories on startup
              </label>
            </div>

            <div class="group">
              <label class="checkbox">
                <input type="checkbox" id="set-checks-on-launch" />
                Check for updates on launch
              </label>
            </div>
          </form>

          <!-- Git -->
          <form class="panel-form hidden" data-panel="git">
            <div class="group">
              <label for="set-git-backend">Backend</label>
              <select id="set-git-backend">
                <option value="git-system">System</option>
                <option value="libgit2">Libgit2</option>
              </select>
            </div>

            <div class="group" style="display:grid; grid-template-columns: 1fr auto; gap:.6rem;">
              <label for="set-auto-fetch">Auto fetch</label>
              <label class="switch"><input type="checkbox" id="set-auto-fetch" /></label>

              <label for="set-auto-fetch-minutes">Interval (minutes)</label>
              <input id="set-auto-fetch-minutes" type="number" min="1" max="720" />
            </div>

            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-prune-on-fetch" /> Prune on fetch</label>
            </div>

            <div class="group">
              <label for="set-watcher-debounce-ms">File watcher debounce (ms)</label>
              <input id="set-watcher-debounce-ms" type="number" min="50" max="10000" />
            </div>

            <div class="group">
              <label for="set-large-repo-threshold-mb">Large repo threshold (MB)</label>
              <input id="set-large-repo-threshold-mb" type="number" min="10" max="10000" />
            </div>

            <div class="group">
              <label for="set-hook-policy">Hooks</label>
              <select id="set-hook-policy">
                <option value="deny">Deny</option>
                <option value="ask">Ask</option>
                <option value="allow">Allow</option>
              </select>
            </div>

            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-respect-autocrlf" /> Respect core.autocrlf</label>
            </div>
          </form>

          <!-- Diff -->
          <form class="panel-form hidden" data-panel="diff">
            <div class="group">
              <label for="set-tab-width">Tab width</label>
              <input id="set-tab-width" type="number" min="1" max="16" />
            </div>

            <div class="group">
              <label for="set-ignore-whitespace">Ignore whitespace</label>
              <select id="set-ignore-whitespace">
                <option value="none">None</option>
                <option value="eol">End-of-line</option>
                <option value="all">All</option>
              </select>
            </div>

            <div class="group">
              <label for="set-max-file-size-mb">Max file size (MB)</label>
              <input id="set-max-file-size-mb" type="number" min="1" max="1024" />
            </div>

            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-intraline" /> Intraline highlight</label>
            </div>

            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-binary-placeholders" /> Show binary placeholders</label>
            </div>
          </form>

          <!-- LFS -->
          <form class="panel-form hidden" data-panel="lfs">
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-lfs-enabled" /> Enable LFS integration</label>
            </div>
            <div class="group">
              <label for="set-lfs-concurrency">Concurrent transfers</label>
              <input id="set-lfs-concurrency" type="number" min="1" max="16" />
            </div>
            <div class="group">
              <label for="set-lfs-bandwidth">Bandwidth cap (kbps, 0=unlimited)</label>
              <input id="set-lfs-bandwidth" type="number" min="0" max="1000000" />
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-lfs-require-lock" /> Require lock before edit</label>
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-lfs-bg-fetch" /> Background fetch on checkout</label>
            </div>
          </form>

          <!-- Performance -->
          <form class="panel-form hidden" data-panel="performance">
            <div class="group">
              <label for="set-graph-cap">Graph node cap</label>
              <input id="set-graph-cap" type="number" min="1000" max="200000" />
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-progressive-render" /> Progressive render</label>
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-gpu-accel" /> GPU acceleration</label>
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-index-warm" /> Warm index on open</label>
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-bg-index-on-battery" /> Background index on battery</label>
            </div>
          </form>

          <!-- UX -->
          <form class="panel-form hidden" data-panel="ux">
            <div class="group">
              <label for="set-ui-scale">UI scale</label>
              <input id="set-ui-scale" type="number" step="0.05" min="0.75" max="2.0" />
            </div>
            <div class="group">
              <label for="set-font-mono">Monospace font</label>
              <input id="set-font-mono" type="text" placeholder="monospace" />
            </div>
            <div class="group">
              <label class="checkbox"><input type="checkbox" id="set-vim-nav" /> Vim-style navigation</label>
            </div>
            <div class="group">
              <label for="set-cb-mode">Color-blind mode</label>
              <select id="set-cb-mode">
                <option value="none">None</option>
                <option value="protanopia">Protanopia</option>
                <option value="deuteranopia">Deuteranopia</option>
                <option value="tritanopia">Tritanopia</option>
              </select>
            </div>
          </form>

          <!-- Footer actions -->
          <div class="sheet-actions" style="margin-top:auto;">
            <button class="tbtn" id="settings-reset" type="button">Restore defaults</button>
            <div style="flex:1"></div>
            <button class="tbtn" data-close type="button">Cancel</button>
            <button class="tbtn primary big" id="settings-save" type="button">Save</button>
          </div>
        </div>
      </section>
    </div>
  </div>
</body>
</html>
